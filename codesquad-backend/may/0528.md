## 0528


> todo

- 알고리즘, 자료구조

  - [ ] programmers 1 문제
  - [ ] codility 1문제
  - [ ] 자료구조 LinkedList 코드 구현
  - [ ] youtube ds binary heap
- CS
- 강의
  - [ ] 호눅스 수업 정리하기 -- Posting
- etc
  
  - [ ] 이력서 작성
- book

  - [ ] 클린 코드 구입
  - [ ] 리팩토링 2판 구입
- posting

  - [ ] signup-project에 대해 정리 (https://github.com/codesquad-member-2020/signup-11)
  - [ ] dust-project 에 대해 정리
  - [ ] todo
  - [ ] sidedish
  - [ ] baseball
  
  - [ ] JVM에 대한 정리
- etc

  - [ ] Java , DB Serializable



> airbnb-target

- [x] spring data jdbc 사용
- [x] oauth (github oauth) 적용
- [x] github action 작성
- [ ] 숙소 등록 tool 제작
- [ ] 세부 검색 기능 제공 (elastic search 적용)
- [x] ec2 , db 서브넷 분리 배포
- [x] nginx 사용





> airbnb-today

- [x] oauth 기능 리팩토링
- [x] Review Aggregation 추가
- [ ] elastic search tutorial 듣기



> honux - class

- S3 스토리지 서비스
  - 내구성과 가용성이 보장되어야햠
  - 둘 중에 하나만 꼽으라 하면, **내구성**
- 아마존에서 가장 먼저 나온 서비스
- 데이터는 **반드시 저장되어야 하는 데이터**와, **그렇지 않은 데이터**로 나뉜다.
- 다시 만들어 낼 수 있는 데이터는 저장할 필요 없음.
  - 즉 일단 저장은 하지만, 삭제해도 괜찮음.
  - 고의가 아니라 실수로 깨져도 괜찮음.
- 주기적으로 삭제가 되어야하는 데이터
  - 회원정보..등의 개인정보.
  - 개인정보 보안 기간이 법으로 저장되어 있음.
  - 로그! 쌓아놓아도 보지 않는당

- 시계열 데이터 == 로그

- 하드 디스크는 1년에 망가질 확률이 15%임.
- 3 copy가 그나마 안전한 방법.



- 서버는 홀 수로 유지한다
  - 왜?
  - 요즘 분산 서버들을 헬스 체크 시스템을 가지고 있음.
  - 그런데 어떤 서버가 죽었는지 아닌니 알 수 있는 방법은 다른 서버에서 체크하는 방법밖에 없음
  - 이럴 경우 투표를 통해, 생사여부를 판단하는데, 짝수면 최악의 경우 동수로 나오므로 판단할 수가 없다.
  - 그러므로 분산 시스템의 서버는 홀수갯수로 유지한다.



- 스토리지 서비스는 여러개 있음.
  - 왜?
  - 사용자가 S3에 원하는 특성이 다르기 때문이다.

- Bucket : S3의 저장단위
- Object : Bucket에 저장되는 객체를 일컫는다.
- EBS : eleastic block storage
  - ec2 하드디스크
  - ec2 는 여러개의 하드 디스크를 연결할 수 있음.
    - 그렇지만 하나의 디스크에는 여러개의 ec2 를 연결하기는 힘듬
  - 깨질 수 있음.
- EFS : 일종의 NAS
  - 여러 컴퓨터가 한 대의 스토리지를 붙도록
- hot data : 자주 사용하는 데이터
- cold data : 자주 사용하지 않는 데이터

- 글래셔스 : cold data 저장하는 장소
  - 저렴함. 1G 에 2센트정도
  - 느리다. 데이터 불러오는 데 ~시간 단위로 걸린다.
  - 보통 오래된 로그를 저장하는 데 사용한다.
  - 정보통신보호법을 위해서 유용하게 사용할 수 있음(어느정도 지난 데이터 삭제등등)

- 일반적으로 데이터는 90 / 10 법칙을 가짐
  - 90 % 요청을 10% 데이터가 처리한다.
- 스노우 볼 : aws snoball truck



#### AWS S3

- 저장되는 객체마다 고유한 URL을 가진다.
- 리전 기반 서비스
  - 서버가 물리적인 데이터 센터에 여러곳으로 나뉘어져 있음.
- 내구도 엄청 높음 .... 우리가 살아있는 동안 깨질 위험 없음
- 가용성 99.99% 가끔식 다운될 수 있음.



- 배포될 때 결과물을 `아티팩트`라고함
- 만능 스토리지

- 노션에 업로드하는 이미지들이 여기에 들어감.
- 모든 클라우드는 CPU가 제일 비쌈
  - 그 다음 네트워크
  - 그 다음이 스토리지...

- 프리티어는 30G 무료
- 같은 리전에 있는 S3는 네트워크 비용이 공짜
- 버킷 : 반드시 고유한 이름을 가져야 함.
- aws s3, serverless 좋음.
- aws configure을 통해서 secret key를 설정하는 것을 별로 좋지 못한 패턴임
- s3는 폴더라는 개념이 존재하지 않는다.
  - 개발자는 s3 에 폴더가 존재하지 않음을 알고 있어야 한다.
- Prefix로 파일 이름 앞에 붙는다고 볼 수 있음.

- Prefix가 같다는 것은 같은 서버에 저장될 확률이 높음.
- S3는 key 를 통해 object를 찾는다
  - key는 url
  - 만약에 같은 url이면 충돌이 난다.
  - 잘 분산시키기 위해서는 유니크한 url을 만드는게 좋음.
- s3의 성능을 높히려면
  - 여러 prefixf를 사용
  - cloudFront CDN
  - S3 가속기능 이용



- 접근권한
  - Presigned URL
    - API, CLI 를 이용해서 해당 객체에 대한 접근권한을 조정할 수 있는 방법.
- `s3 url?torrent `
  - 큰 파일일 경우, 고객들끼리 P2P로 공유하도록 만들어준다.
  - 그러면 요금의 40~50%를 절약할 수 있따!

